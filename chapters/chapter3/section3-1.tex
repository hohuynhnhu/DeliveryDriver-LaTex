\section{Kiến trúc tổng thể hệ thống}

Hệ thống được xây dựng theo mô hình client--server và triển khai theo kiến trúc microservices,
nhằm đảm bảo khả năng mở rộng, dễ bảo trì và phân tách rõ ràng các chức năng nghiệp vụ.
Các dịch vụ backend không giao tiếp trực tiếp với frontend mà thông qua một API Gateway,
đóng vai trò là điểm truy cập duy nhất của hệ thống.

\textbf{Tầng trình diễn (Presentation Layer)} bao gồm:
\begin{itemize}
    \item \textbf{Ứng dụng di động (Mobile Application)}: được xây dựng theo mô hình MVVM,
    phục vụ cho Customer và Driver.
    \item \textbf{Ứng dụng web (Web Application)}: được xây dựng bằng Nuxt,
    phục vụ cho Admin và người dùng quản trị hệ thống.
\end{itemize}

\textbf{Tầng backend (Application Layer)} được triển khai theo kiến trúc microservices
sử dụng FastAPI, bao gồm các dịch vụ chính:
\begin{itemize}
    \item Authentication Service (Dịch vụ xác thực)
    \item Order Service (Dịch vụ quản lý đơn hàng)
    \item Driver Scheduling Service (Dịch vụ điều phối tài xế)
    \item Routing Optimization Service (Dịch vụ tối ưu lộ trình)
    \item Route Analysis Service (Dịch vụ phân tích tuyến đường)
    \item Incident Management Service (Dịch vụ xử lý sự cố)
    \item Notification Service (Dịch vụ thông báo)
\end{itemize}

Routing Optimization Service chịu trách nhiệm tính toán tuyến đường tối ưu dựa trên
dữ liệu bản đồ và khoảng cách thực tế từ OSRM.
Route Analysis Service thực hiện phân tích lịch sử di chuyển, đánh giá hiệu quả tuyến đường
(thời gian, quãng đường, độ trễ) nhằm hỗ trợ tối ưu vận hành.

Incident Management Service chịu trách nhiệm tiếp nhận, quản lý và xử lý các sự cố phát sinh
trong quá trình giao hàng như tai nạn, hỏng phương tiện hoặc thay đổi tài xế,
đồng thời phối hợp với các dịch vụ khác để cập nhật trạng thái hệ thống.

Tất cả các service backend giao tiếp với nhau thông qua FAST API và được định tuyến
thông qua API Gateway, giúp tập trung xử lý xác thực, phân quyền và kiểm soát luồng dữ liệu.

\textbf{Tầng dữ liệu (Data Layer)} sử dụng Supabase (PostgreSQL) để:
\begin{itemize}
    \item Lưu trữ dữ liệu nghiệp vụ (orders, drivers, routes, profiles, ...)
    \item Quản lý xác thực người dùng và phân quyền truy cập
    thông qua JWT và Row Level Security (RLS)
\end{itemize}

Ngoài ra, hệ thống tích hợp với các dịch vụ bản đồ mã nguồn mở:
\begin{itemize}
    \item \textbf{OpenStreetMap (OSM)}: cung cấp dữ liệu bản đồ
    \item \textbf{OSRM}: hỗ trợ tính toán khoảng cách và truy vấn tuyến đường thực tế
\end{itemize}



\begin{figure}[H]
\centering
\begin{tikzpicture}[
    node distance=1cm,
    every node/.style={
        draw, rectangle, rounded corners, align=center,
        minimum width=3cm, minimum height=0.9cm
    },
    arrow/.style={->, semithick}
]

% ===== Clients =====
\node (customer) {Customer App\\Ứng dụng khách hàng\\(Mobile -- MVVM)};
\node (driver) [below=of customer] {Driver App\\Ứng dụng tài xế\\(Mobile -- MVVM)};
\node (admin) [below=of driver] {Admin Web\\Trang quản trị\\(Nuxt)};

% ===== API Gateway =====
\node (gateway) [right=1.4cm of driver] {API Gateway\\Cổng giao tiếp API};

% ===== Backend Services =====
\node (auth)     [right=1.6cm of gateway, yshift=3.8cm]
{Authentication Service\\Dịch vụ xác thực};

\node (order)    [below=of auth]
{Order Service\\Dịch vụ đơn hàng};

\node (schedule) [below=of order]
{Driver Scheduling Service\\Dịch vụ điều phối tài xế};

\node (routing)  [below=of schedule]
{Routing Optimization Service\\Dịch vụ tối ưu lộ trình};

\node (analysis) [below=of routing]
{Route Analysis Service\\Dịch vụ phân tích tuyến đường};

\node (incident) [below=of analysis]
{Incident Management Service\\Dịch vụ xử lý sự cố};

\node (noti)     [below=of incident]
{Notification Service\\Dịch vụ thông báo};

% ===== Database =====
\node (db) [right=1.4cm of schedule]
{Supabase\\PostgreSQL + Auth};

% ===== External APIs =====
\node (osrm) [below=of db]
{OSRM / OSM\\Dịch vụ bản đồ};

% ===== Connections =====
\draw[arrow] (customer) -- (gateway);
\draw[arrow] (driver) -- (gateway);
\draw[arrow] (admin) -- (gateway);

\draw[arrow] (gateway) -- (auth);
\draw[arrow] (gateway) -- (order);
\draw[arrow] (gateway) -- (schedule);
\draw[arrow] (gateway) -- (routing);
\draw[arrow] (gateway) -- (analysis);
\draw[arrow] (gateway) -- (incident);
\draw[arrow] (gateway) -- (noti);

\draw[arrow] (auth) -- (db);
\draw[arrow] (order) -- (db);
\draw[arrow] (schedule) -- (db);
\draw[arrow] (routing) -- (db);
\draw[arrow] (analysis) -- (db);
\draw[arrow] (incident) -- (db);
\draw[arrow] (noti) -- (db);

\draw[arrow] (routing) -- (osrm);
\draw[arrow] (analysis) -- (osrm);

\end{tikzpicture}
\caption{Kiến trúc tổng thể hệ thống giao hàng theo mô hình microservices}
\label{fig:system_architecture}
\end{figure}


Yêu cầu chức năng 
\begin{figure}[H]
    \centering
    \includegraphics[height=0.3\textheight]{frontmatter/image/authentication.jpg}
    \caption{Sơ đồ phân rã chức năng Xác thực và Phân quyền}
    \label{fig:auth-authorization}
\end{figure}

Dựa trên sơ đồ phân rã chức năng Xác thực và Phân quyền, hệ thống bao gồm các yêu cầu chức năng sau:
\begin{itemize}
    \item Cho phép người dùng đăng ký tài khoản bằng email hoặc Google.
    \item Thực hiện xác thực email sau khi đăng ký.
    \item Hỗ trợ đăng nhập bằng email hoặc tài khoản mạng xã hội.
    \item Tạo mã xác thực JWT sau khi đăng nhập thành công.
    \item Kiểm tra vai trò người dùng để thực hiện phân quyền truy cập.
    \item Cung cấp chức năng quên và đặt lại mật khẩu thông qua email.
    \item Quản lý phiên làm việc của người dùng trong hệ thống.
\end{itemize}

\begin{figure}[H]
    \centering
    \includegraphics[height=0.3\textheight]{frontmatter/image/user_management.jpg}
    \caption{Sơ đồ phân rã chức năng Quản lý người dùng}
    \label{fig:user-management}
\end{figure}

Dựa trên sơ đồ phân rã chức năng Quản lý người dùng, hệ thống bao gồm các yêu cầu chức năng sau:
\begin{itemize}
    \item \textbf{Quản lý hồ sơ người dùng (Profile Management):}
    \begin{itemize}
        \item Cập nhật thông tin cá nhân của người dùng.
        \item Tải lên và thay đổi ảnh đại diện (avatar).
        \item Thay đổi mật khẩu đăng nhập.
    \end{itemize}

    \item \textbf{Quản lý phân quyền (Role Management):}
    \begin{itemize}
        \item Phân quyền cho người dùng thông thường.
        \item Phân quyền cho tài xế.
        \item Phân quyền cho quản lý.
        \item Phân quyền cho quản trị viên.
    \end{itemize}

    \item \textbf{Quản lý tài xế (Driver Management):}
    \begin{itemize}
        \item Đăng ký tài xế mới vào hệ thống.
        \item Cập nhật thông tin phương tiện của tài xế.
        \item Theo dõi hiệu suất làm việc của tài xế.
        \item Quản lý trạng thái hoạt động của tài xế.
    \end{itemize}

    \item \textbf{Quản lý khách hàng (Customer Management):}
    \begin{itemize}
        \item Đăng ký khách hàng.
        \item Quản lý và cập nhật địa chỉ khách hàng.
        \item Theo dõi lịch sử đơn hàng của khách hàng.
    \end{itemize}
\end{itemize}

\begin{figure}[H]
    \centering
    \includegraphics[height=0.3\textheight]{frontmatter/image/order-management.jpg}
    \caption{Sơ đồ phân rã chức năng Quản lý Đơn hàng}
    \label{fig:order-management}
\end{figure}

Dựa trên Hình~\ref{fig:order-management}, phân hệ \textbf{Quản lý Đơn hàng} đóng vai trò trung tâm trong hệ thống giao nhận, chịu trách nhiệm quản lý toàn bộ vòng đời của đơn hàng từ khi được tạo, xử lý, theo dõi cho đến khi hoàn tất hoặc hủy bỏ. Phân hệ này được phân rã thành các nhóm chức năng chính như sau:

\subsubsection{Quản lý Đơn hàng thường}

Chức năng này cho phép người dùng thao tác với các đơn hàng thông thường trong hệ thống, bao gồm:
\begin{itemize}
    \item \textbf{Tạo đơn hàng}: Cho phép tạo mới đơn hàng với các thông tin cần thiết như người gửi, người nhận, địa chỉ giao hàng và loại dịch vụ.
    \item \textbf{Xem đơn hàng}: Cho phép người dùng theo dõi thông tin chi tiết và trạng thái hiện tại của đơn hàng.
    \item \textbf{Cập nhật đơn hàng}: Cho phép chỉnh sửa thông tin đơn hàng khi đơn chưa được xử lý.
    \item \textbf{Hủy đơn hàng}: Cho phép hủy đơn hàng khi đơn chưa được duyệt hoặc chưa được giao cho tài xế.
\end{itemize}

\subsubsection{Xử lý Đơn hàng}

Nhóm chức năng này hỗ trợ nhân viên hoặc quản lý trong quá trình xử lý các đơn hàng đã được tạo:
\begin{itemize}
    \item \textbf{Duyệt đơn hàng}: Xác nhận đơn hàng hợp lệ để đưa vào quá trình giao nhận.
    \item \textbf{Từ chối đơn hàng}: Từ chối các đơn hàng không hợp lệ hoặc không đáp ứng điều kiện vận chuyển.
    \item \textbf{Chỉnh sửa đơn hàng}: Điều chỉnh thông tin đơn hàng trong quá trình xử lý.
    \item \textbf{Hủy đơn hàng}: Hủy đơn trong trường hợp phát sinh lỗi hoặc yêu cầu đặc biệt.
    \item \textbf{Xem lịch sử đơn hàng}: Theo dõi toàn bộ lịch sử xử lý và trạng thái của đơn hàng.
\end{itemize}

\subsubsection{Xử lý Đột xuất}

Chức năng này hỗ trợ xử lý các tình huống phát sinh hoặc đơn hàng khẩn cấp:
\begin{itemize}
    \item \textbf{Nhận đơn khẩn cấp}: Tiếp nhận các đơn hàng có mức độ ưu tiên cao.
    \item \textbf{Đánh giá khả thi}: Đánh giá khả năng thực hiện đơn hàng dựa trên nguồn lực hiện có.
    \item \textbf{Chèn vào lộ trình}: Tích hợp đơn hàng khẩn cấp vào lộ trình giao hàng hiện tại.
    \item \textbf{Tái tối ưu lộ trình}: Điều chỉnh và tối ưu lại lộ trình giao hàng nhằm đảm bảo hiệu quả vận chuyển.
\end{itemize}

\subsubsection{Quản lý Dịch vụ}

Nhóm chức năng này cho phép quản lý các loại hình dịch vụ vận chuyển được sử dụng trong hệ thống:
\begin{itemize}
    \item \textbf{Tạo dịch vụ}: Thêm mới các loại dịch vụ vận chuyển.
    \item \textbf{Xem dịch vụ}: Hiển thị danh sách và thông tin chi tiết các dịch vụ.
    \item \textbf{Cập nhật dịch vụ}: Chỉnh sửa thông tin dịch vụ như giá cước và thời gian giao hàng.
    \item \textbf{Hủy dịch vụ}: Ngừng cung cấp các dịch vụ không còn phù hợp.
\end{itemize}


\begin{figure}[H]
    \centering
    \includegraphics[height=0.3\textheight]{frontmatter/image/job-management.jpg}
    \caption{Sơ đồ phân rã chức năng Quản lý Công việc}
    \label{fig:job-management}
\end{figure}

Dựa trên Hình~\ref{fig:job-management}, phân hệ \textbf{Quản lý Công việc} chịu trách nhiệm tổ chức, điều phối và giám sát toàn bộ các công việc giao nhận trong hệ thống. Phân hệ này hỗ trợ việc tối ưu lộ trình, phân công nhiệm vụ cho tài xế, xử lý các tình huống đột xuất và quản lý địa điểm giao hàng nhằm đảm bảo quá trình vận hành diễn ra hiệu quả và chính xác.

\subsubsection{Quản lý Điều hướng giao hàng}

Chức năng này hỗ trợ tài xế trong quá trình thực hiện giao hàng thông qua việc cung cấp lộ trình và chỉ dẫn di chuyển:
\begin{itemize}
    \item \textbf{Hiển thị lộ trình}: Hiển thị lộ trình giao hàng đã được hệ thống tính toán.
    \item \textbf{Tính toán lộ trình}: Xác định lộ trình tối ưu dựa trên khoảng cách, thời gian và điều kiện giao thông.
    \item \textbf{Dẫn đường theo lộ trình}: Hỗ trợ tài xế di chuyển theo lộ trình đã được đề xuất.
\end{itemize}

\subsubsection{Quản lý Nhận đơn gấp}

Nhóm chức năng này hỗ trợ xử lý các đơn hàng có mức độ ưu tiên cao hoặc phát sinh đột xuất:
\begin{itemize}
    \item \textbf{Nhận thông báo đơn hàng đột xuất}: Tiếp nhận thông báo về các đơn hàng gấp từ hệ thống.
    \item \textbf{Hiển thị thông tin đơn gấp}: Cung cấp chi tiết đơn hàng để tài xế hoặc quản lý đánh giá.
    \item \textbf{Chấp nhận hoặc từ chối đơn gấp}: Cho phép tài xế quyết định nhận hoặc từ chối đơn hàng đột xuất.
    \item \textbf{Thông báo kết quả cho quản lý}: Gửi kết quả xử lý đơn gấp đến người quản lý.
\end{itemize}

\subsubsection{Tạo Lịch trình}

Chức năng này cho phép hệ thống xây dựng và quản lý lịch trình giao hàng cho tài xế:
\begin{itemize}
    \item \textbf{Tạo lịch cho tài xế}: Lập kế hoạch giao hàng theo từng tài xế.
    \item \textbf{Gán đơn vào lịch}: Phân bổ các đơn hàng cụ thể vào lịch trình.
    \item \textbf{Tính thời gian dự kiến}: Ước lượng thời gian hoàn thành các công việc giao hàng.
    \item \textbf{Thông báo cho tài xế}: Gửi thông báo lịch trình đến tài xế.
\end{itemize}

\subsubsection{Quản lý Nhận việc}

Nhóm chức năng này hỗ trợ tài xế trong việc tiếp nhận và thực hiện các công việc được giao:
\begin{itemize}
    \item \textbf{Nhận danh sách đơn hàng từ quản lý}: Tài xế tiếp nhận danh sách đơn hàng được phân công.
    \item \textbf{Nhận danh sách lộ trình giao hàng}: Tiếp nhận lộ trình tương ứng với các đơn hàng.
    \item \textbf{Xác nhận đã nhận việc}: Xác nhận tiếp nhận công việc được giao.
    \item \textbf{Xem chi tiết đơn hàng}: Xem thông tin chi tiết của từng đơn hàng.
    \item \textbf{Cập nhật lại lộ trình giao hàng}: Điều chỉnh lộ trình trong quá trình thực hiện.
    \item \textbf{Báo cáo sự cố}: Báo cáo các sự cố phát sinh trong quá trình giao hàng.
\end{itemize}

\subsubsection{Quản lý Địa điểm}

Chức năng này cho phép quản lý các địa điểm phục vụ cho quá trình giao nhận:
\begin{itemize}
    \item \textbf{Tạo địa điểm}: Thêm mới các địa điểm giao nhận vào hệ thống.
    \item \textbf{Hiển thị danh sách địa điểm}: Xem danh sách các địa điểm hiện có.
    \item \textbf{Xem, cập nhật hoặc xóa địa điểm}: Chỉnh sửa hoặc loại bỏ các địa điểm không còn sử dụng.
\end{itemize}


\begin{figure}[H]
    \centering
    \includegraphics[height=0.3\textheight]{frontmatter/image/tracking-monitoring.jpg}
    \caption{Sơ đồ phân rã chức năng Theo dõi và Giám sát}
    \label{fig:tracking-monitoring}
\end{figure}

Dựa trên Hình~\ref{fig:tracking-monitoring}, phân hệ \textbf{Theo dõi và Giám sát} có nhiệm vụ theo dõi hành trình di chuyển của người dùng và tài xế, giám sát trạng thái đơn hàng theo thời gian thực, đồng thời cung cấp thông tin trực quan cho quản lý và khách hàng. Phân hệ này đóng vai trò quan trọng trong việc nâng cao tính minh bạch, khả năng kiểm soát và hiệu quả vận hành của hệ thống.

\subsubsection{Quản lý Hành trình Người dùng}

Chức năng này cho phép người dùng quản lý các lộ trình và điểm đến trong quá trình giao nhận:
\begin{itemize}
    \item \textbf{Quản lý lộ trình}: Quản lý các tuyến đường giao hàng của người dùng.
    \item \textbf{Quản lý điểm đến}: Thêm, sửa, xóa và cập nhật thông tin các điểm đến.
    \item \textbf{Tính toán tuyến đường tối ưu}: Xác định tuyến đường ngắn nhất hoặc hiệu quả nhất.
    \item \textbf{Hiển thị tuyến đường trên bản đồ}: Trực quan hóa lộ trình giao hàng trên bản đồ số.
    \item \textbf{Cập nhật vị trí người dùng theo thời gian thực}: Theo dõi vị trí hiện tại của người dùng.
\end{itemize}

\subsubsection{Lịch sử Chuyến đi}

Nhóm chức năng này hỗ trợ tra cứu và tái sử dụng các chuyến đi đã thực hiện:
\begin{itemize}
    \item \textbf{Xem danh sách chuyến đi đã hoàn thành}: Hiển thị toàn bộ các chuyến đi trước đó.
    \item \textbf{Xem chi tiết chuyến đi}: Cung cấp thông tin chi tiết về lộ trình, thời gian và trạng thái chuyến đi.
    \item \textbf{Sao chép (clone) chuyến đi cũ}: Cho phép tạo lại chuyến đi mới dựa trên chuyến đi trước đó.
\end{itemize}

\subsubsection{GPS Tracking}

Chức năng GPS Tracking cho phép hệ thống thu thập và xử lý dữ liệu vị trí:
\begin{itemize}
    \item \textbf{Bật GPS trên ứng dụng}: Kích hoạt chức năng định vị trên thiết bị người dùng hoặc tài xế.
    \item \textbf{Thu thập tọa độ}: Ghi nhận dữ liệu vị trí theo thời gian thực.
    \item \textbf{Gửi dữ liệu GPS về máy chủ}: Truyền dữ liệu vị trí định kỳ (5--10 giây/lần).
    \item \textbf{Lưu trữ dữ liệu vào cơ sở dữ liệu}: Phục vụ cho việc theo dõi và phân tích sau này.
\end{itemize}

\subsubsection{Giám sát Thời gian Thực (Realtime Monitoring)}

Nhóm chức năng này hỗ trợ giám sát hệ thống theo thời gian thực:
\begin{itemize}
    \item \textbf{Thiết lập kết nối WebSocket}: Duy trì kết nối liên tục giữa máy khách và máy chủ.
    \item \textbf{Truyền dữ liệu GPS theo thời gian thực}: Cập nhật vị trí liên tục.
    \item \textbf{Cập nhật bản đồ thời gian thực}: Hiển thị thay đổi vị trí trực tiếp trên bản đồ.
    \item \textbf{Hiển thị cho quản lý}: Cung cấp giao diện giám sát cho quản lý hệ thống.
    \item \textbf{Hiển thị cho khách hàng}: Cho phép khách hàng theo dõi đơn hàng đang vận chuyển.
\end{itemize}

\subsubsection{Giám sát}

Chức năng này hỗ trợ quản lý trong việc theo dõi tổng thể hoạt động của hệ thống:
\begin{itemize}
    \item \textbf{Xem vị trí nhân viên theo thời gian thực}: Theo dõi vị trí tài xế đang hoạt động.
    \item \textbf{Xem đơn hàng hiện tại}: Giám sát các đơn hàng đang được xử lý.
    \item \textbf{Xem danh sách nhân viên}: Theo dõi danh sách và trạng thái của nhân viên.
\end{itemize}


\begin{figure}[H]
    \centering
    \includegraphics[height=0.3\textheight]{frontmatter/image/operation-management.jpg}
    \caption{Sơ đồ phân rã chức năng Quản lý Vận hành}
    \label{fig:operation-management}
\end{figure}

Dựa trên Hình~\ref{fig:operation-management}, phân hệ \textbf{Quản lý Vận hành} chịu trách nhiệm điều phối, kiểm soát và xử lý các hoạt động vận hành trong hệ thống giao nhận. Phân hệ này hỗ trợ tiếp nhận booking từ khách hàng, quản lý đơn hàng và công việc, đồng thời xử lý các sự cố phát sinh nhằm đảm bảo hoạt động của hệ thống diễn ra liên tục và hiệu quả.

\subsubsection{Quản lý Tiếp nhận Booking}

Chức năng này cho phép hệ thống tiếp nhận và xử lý các yêu cầu đặt dịch vụ từ khách hàng:
\begin{itemize}
    \item \textbf{Xem danh sách đơn hàng từ khách hàng}: Hiển thị danh sách các booking được gửi từ phía khách hàng.
    \item \textbf{Xem chi tiết thông tin đơn hàng}: Cung cấp đầy đủ thông tin chi tiết của từng booking.
    \item \textbf{Xử lý booking}: Thực hiện xử lý các yêu cầu đặt dịch vụ.
    \item \textbf{Duyệt đơn hàng}: Xác nhận booking hợp lệ để đưa vào hệ thống vận hành.
    \item \textbf{Từ chối đơn hàng}: Từ chối các booking không phù hợp hoặc không đủ điều kiện.
    \item \textbf{Phản hồi kết quả cho khách hàng}: Thông báo kết quả xử lý booking đến khách hàng.
\end{itemize}

\subsubsection{Quản lý Điều phối}

Nhóm chức năng này hỗ trợ điều phối các hoạt động vận hành trong hệ thống:
\begin{itemize}
    \item \textbf{Quản lý đơn hàng}: Theo dõi và quản lý các đơn hàng trong quá trình vận hành.
    \item \textbf{Phân loại đơn hàng}: Phân loại đơn hàng theo trạng thái hoặc mức độ ưu tiên.
    \item \textbf{Cập nhật đơn hàng}: Cập nhật thông tin đơn hàng trong quá trình xử lý.
    \item \textbf{Xem đơn hàng}: Tra cứu và theo dõi tình trạng đơn hàng.
\end{itemize}

\subsubsection{Quản lý Công việc}

Chức năng này cho phép quản lý các công việc phát sinh trong quá trình vận hành:
\begin{itemize}
    \item \textbf{Tạo công việc}: Tạo mới các công việc liên quan đến vận hành.
    \item \textbf{Xem công việc}: Xem danh sách và chi tiết các công việc.
    \item \textbf{Phân loại công việc}: Phân loại công việc theo mức độ và trạng thái.
    \item \textbf{Cập nhật công việc}: Cập nhật thông tin công việc trong quá trình thực hiện.
    \item \textbf{Hủy công việc}: Hủy các công việc không còn cần thiết.
\end{itemize}

\subsubsection{Quản lý Sự cố Đột xuất}

Chức năng này hỗ trợ xử lý các sự cố phát sinh trong quá trình vận hành:
\begin{itemize}
    \item \textbf{Xem sự cố}: Theo dõi danh sách và chi tiết các sự cố.
    \item \textbf{Cập nhật sự cố}: Cập nhật trạng thái và thông tin xử lý sự cố.
\end{itemize}


\subsection{Phân tích mối quan hệ giữa điểm nhận và điểm giao}

\begin{figure}[H]
    \centering
    \includegraphics[height=0.3\textheight]{frontmatter/image/rfm-management.jpg}
    \caption{Sơ đồ phân rã phân tích mối quan hệ giữa điểm nhận và điểm giao}
    \label{fig:rfm-management}
\end{figure}
Phân hệ này nhằm xác định các cặp điểm nhận -- điểm giao
thường xuyên xuất hiện cùng nhau trong các đơn hàng,
từ đó hỗ trợ đề xuất vị trí mở bưu cục hoặc điểm trung chuyển
nhằm tối ưu hóa hoạt động vận hành và phân phối.

\subsubsection{Xem kết quả phân tích}

Chức năng này cho phép người quản trị theo dõi và khai thác
kết quả phân tích mối quan hệ giữa các điểm nhận và điểm giao:
\begin{itemize}
    \item Hiển thị danh sách các cặp điểm nhận -- điểm giao có mối liên hệ.
    \item Cung cấp các chỉ số đánh giá mức độ liên kết của từng cặp.
\end{itemize}

\subsubsection{Phân tích giỏ hàng}

Chức năng này thực hiện phân tích dữ liệu đơn hàng
dưới dạng các giỏ hàng, trong đó mỗi giỏ hàng bao gồm
thông tin điểm nhận và điểm giao tương ứng.
Thông qua quá trình này, hệ thống phát hiện các cặp điểm
thường xuyên xuất hiện cùng nhau trong tập dữ liệu.

\subsubsection{Tính toán các chỉ số đánh giá}

Phân hệ sử dụng các chỉ số trong phân tích giỏ hàng
để đánh giá mức độ liên quan giữa điểm nhận và điểm giao:
\begin{itemize}
    \item \textbf{Support}: Tỷ lệ đơn hàng chứa đồng thời một điểm nhận và một điểm giao cụ thể.
    \item \textbf{Confidence}: Xác suất xuất hiện điểm giao khi đã có điểm nhận.
    \item \textbf{Lift}: Mức độ phụ thuộc giữa điểm nhận và điểm giao,
    dùng để đánh giá ý nghĩa của mối quan hệ.
\end{itemize}

\subsubsection{Cập nhật và đề xuất}

Dựa trên kết quả tính toán,
các cặp điểm nhận -- điểm giao có giá trị Support và Lift cao
được xem là các tuyến vận chuyển ổn định.
Phân hệ tiến hành cập nhật kết quả phân tích khi có dữ liệu mới
và đề xuất vị trí mở bưu cục hoặc điểm trung chuyển
tại các khu vực phù hợp nhằm nâng cao hiệu quả khai thác mạng lưới logistics.



\section{Usecase Diagram }

\subsection{Các tác nhân của hệ thống}

Hệ thống có các tác nhân chính bao gồm:
\begin{itemize}
    \item Khách hàng (Customer)
    \item Quản lý vận hành (Admin)
    \item Nhân viên giao hàng (Driver)
    \item Hệ thống (System)
\end{itemize}

\subsection{Use Case tổng quát}
\begin{figure}[H]
    \centering
    \includegraphics[height=0.5\textheight]{frontmatter/image/hethong.jpg}
    \caption{Use case Diagram tổng quát}
    \label{fig:intro}
\end{figure}
\subsection{Actors của hệ thống}

Các actor trong hệ thống giao nhận hàng bao gồm:

\begin{itemize}
    \item \textbf{Customer}: Người dùng cuối sử dụng ứng dụng để tạo đơn giao hàng, lựa chọn hình thức gửi hàng (gửi tại bưu cục hoặc yêu cầu lấy hàng), theo dõi hành trình đơn hàng và xem lịch sử các thông báo liên quan đến đơn giao.
    
    \item \textbf{Driver}: Nhân viên giao nhận trực tiếp thực hiện việc lấy hàng và giao hàng. Driver sử dụng hệ thống để xem lịch phân công, cập nhật trạng thái đơn hàng, chia sẻ vị trí theo thời gian thực, xác nhận đã lấy hàng, đã giao hàng và báo cáo các sự cố hoặc trường hợp giao hàng thất bại.
    
    \item \textbf{Admin}: Người quản trị hệ thống chịu trách nhiệm điều phối và giám sát toàn bộ hoạt động giao nhận. Admin thực hiện các chức năng như phân công đơn hàng cho tài xế, giám sát hoạt động của các driver, tối ưu lộ trình và xử lý các vấn đề phát sinh liên quan đến đơn hàng.
    
    \item \textbf{User}: Actor tổng quát đại diện cho các loại người dùng trong hệ thống. User thực hiện các chức năng chung như đăng ký tài khoản, đăng nhập hệ thống, quản lý hồ sơ cá nhân và quản lý sổ địa chỉ.
\end{itemize}

Dựa trên yêu cầu hệ thống, các use case chính bao gồm:
\begin{itemize}
    \item Xác thực và quản lý hồ sơ người dùng
    \item Đặt lịch và quản lý đơn hàng
    \item Tối ưu lộ trình giao hàng
    \item Theo dõi vị trí và thông báo
\end{itemize}



\subsection{Use case Diagram chi tiết về xử lý đăng nhập đăng ký và hồ sơ}

\begin{figure}[H]
    \centering
    \includegraphics[height=0.4\textheight]{frontmatter/image/dangkidangnhap.jpg}
    \caption{Use case Diagram người dùng đăng nhập đăng ký và hồ sơ}
    \label{fig:intro}
\end{figure}
Dưới đây là các đặc tả use case của người dùng đăng nhập đăng ký và hồ sơ:

\begin{table}[H]
\centering
\caption{UC-01: Đăng nhập hệ thống}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{4cm}|p{10cm}|}
\hline
\textbf{Use Case ID} & UC-01 \\ \hline
\textbf{Tên Use Case} & Đăng nhập hệ thống \\ \hline
\textbf{Actor} & Customer, Driver, Admin \\ \hline
\textbf{Mô tả} & Cho phép người dùng truy cập hệ thống bằng tài khoản đã đăng ký. Hệ thống xác thực, cấp quyền và chuyển hướng đến màn hình làm việc tương ứng. \\ \hline
\textbf{Tiền điều kiện} & 
1. Tài khoản đã được kích hoạt.\\
& 2. Thiết bị có kết nối Internet. \\ \hline
\textbf{Luồng chính} &
1. Actor mở ứng dụng, chọn Đăng nhập.\\
& 2. Nhập Email hoặc Số điện thoại và Mật khẩu.\\
& 3. Nhấn nút "Đăng nhập".\\
& 4. Hệ thống kiểm tra xác thực.\\
& 5. Hệ thống lấy thông tin hồ sơ.\\
& 6. Thông báo đăng nhập thành công và chuyển hướng vào trang chủ. \\ \hline
\textbf{Luồng phụ} &
2a. Đăng nhập Google: Chọn Google $\rightarrow$ Xác thực $\rightarrow$ Vào hệ thống.\\
& 4a. Sai thông tin: Báo lỗi "Tài khoản hoặc mật khẩu không đúng".\\
& 4b. Chưa kích hoạt: Yêu cầu kiểm tra email kích hoạt. \\ \hline
\textbf{Hậu điều kiện} &
Thành công: Người dùng truy cập được hệ thống và lưu phiên làm việc.\\
& Thất bại: Vẫn ở màn hình đăng nhập. \\ \hline
\end{tabular}
\end{table}

\begin{table}[H]
\centering
\caption{UC-02: Đăng ký tài khoản}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{4cm}|p{10cm}|}
\hline
\textbf{Use Case ID} & UC-02 \\ \hline
\textbf{Actor} & Customer \\ \hline
\textbf{Mô tả} & Người dùng mới tạo tài khoản để sử dụng dịch vụ. Hệ thống tự động tạo hồ sơ và gửi email xác thực. \\ \hline
\textbf{Tiền điều kiện} & Email chưa từng được sử dụng trong hệ thống. \\ \hline
\textbf{Luồng chính} &
1. Chọn "Đăng ký".\\
& 2. Nhập Họ tên, Email, Mật khẩu, Số điện thoại.\\
& 3. Nhấn "Đăng ký".\\
& 4. Hệ thống kiểm tra dữ liệu hợp lệ.\\
& 5. Tạo tài khoản và hồ sơ người dùng.\\
& 6. Gửi email xác thực.\\
& 7. Thông báo kiểm tra email. \\ \hline
\textbf{Luồng phụ} &
4a. Email đã tồn tại: Báo lỗi và yêu cầu nhập email khác.\\
& 4b. Mật khẩu yếu: Yêu cầu tối thiểu 6 ký tự. \\ \hline
\textbf{Hậu điều kiện} & Tài khoản được tạo ở trạng thái chờ xác thực. \\ \hline
\end{tabular}
\end{table}

\begin{table}[H]
\centering
\caption{UC-03: Quên mật khẩu}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{4cm}|p{10cm}|}
\hline
\textbf{Actor} & Customer, Driver, Admin \\ \hline
\textbf{Mô tả} & Hỗ trợ người dùng đặt lại mật khẩu mới thông qua email. \\ \hline
\textbf{Tiền điều kiện} & Tài khoản đã tồn tại trong hệ thống. \\ \hline
\textbf{Luồng chính} &
1. Chọn "Quên mật khẩu".\\
& 2. Nhập Email đã đăng ký.\\
& 3. Nhấn "Gửi yêu cầu".\\
& 4. Hệ thống gửi link đặt lại mật khẩu.\\
& 5. Actor mở email và truy cập link.\\
& 6. Nhập mật khẩu mới và xác nhận.\\
& 7. Hệ thống cập nhật và thông báo thành công. \\ \hline
\textbf{Luồng phụ} &
2a. Sai định dạng email: Yêu cầu nhập lại.\\
& 5a. Link hết hạn: Yêu cầu gửi lại yêu cầu mới. \\ \hline
\textbf{Hậu điều kiện} & Mật khẩu mới có hiệu lực, mật khẩu cũ bị hủy. \\ \hline
\end{tabular}
\end{table}

\begin{table}[H]
\centering
\caption{UC-04: Xem hồ sơ cá nhân}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{4cm}|p{10cm}|}
\hline
\textbf{Use Case ID} & UC-04 \\ \hline
\textbf{Actor} & Customer, Driver, Admin \\ \hline
\textbf{Mô tả} & Người dùng xem lại thông tin cá nhân của mình trên hệ thống. \\ \hline
\textbf{Tiền điều kiện} & Người dùng đã đăng nhập thành công. \\ \hline
\textbf{Luồng chính} &
1. Chọn menu "Tài khoản" hoặc nhấn vào ảnh đại diện.\\
& 2. Hệ thống tải dữ liệu hồ sơ từ máy chủ.\\
& 3. Hiển thị thông tin: ảnh đại diện, họ tên, số điện thoại, email, địa chỉ.\\
& 4. Hiển thị thêm trạng thái hoạt động nếu actor là Driver. \\ \hline
\textbf{Luồng phụ} &
2a. Lỗi mạng: Thông báo lỗi kết nối và hiển thị nút "Thử lại". \\ \hline
\textbf{Hậu điều kiện} & Thông tin cá nhân được hiển thị đầy đủ cho người dùng. \\ \hline
\end{tabular}
\end{table}

\begin{table}[H]
\centering
\caption{UC-05: Cập nhật hồ sơ}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{4cm}|p{10cm}|}
\hline
\textbf{Use Case ID} & UC-05 \\ \hline
\textbf{Actor} & Customer, Driver, Admin \\ \hline
\textbf{Mô tả} & Cho phép người dùng chỉnh sửa thông tin cá nhân và thay đổi ảnh đại diện. \\ \hline
\textbf{Tiền điều kiện} & Người dùng đang ở màn hình xem hồ sơ cá nhân. \\ \hline
\textbf{Luồng chính} &
1. Nhấn nút "Chỉnh sửa".\\
& 2. Thay đổi các thông tin văn bản.\\
& 3. Chọn ảnh đại diện mới.\\
& 4. Nhấn "Lưu thay đổi".\\
& 5. Hệ thống tải ảnh và cập nhật dữ liệu.\\
& 6. Thông báo "Cập nhật thành công". \\ \hline
\textbf{Luồng phụ} &
3a. Ảnh không hợp lệ: Báo lỗi kích thước hoặc định dạng.\\
& 5a. Lỗi lưu dữ liệu: Thông báo lỗi hệ thống và yêu cầu thử lại. \\ \hline
\textbf{Hậu điều kiện} & Thông tin mới được lưu và hiển thị ngay lập tức. \\ \hline
\end{tabular}
\end{table}

\begin{table}[H]
\centering
\caption{UC-06: Đổi mật khẩu}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{4cm}|p{10cm}|}
\hline
\textbf{Use Case ID} & UC-06 \\ \hline
\textbf{Actor} & Customer, Driver, Admin \\ \hline
\textbf{Mô tả} & Cho phép người dùng chủ động thay đổi mật khẩu nhằm tăng cường bảo mật. \\ \hline
\textbf{Tiền điều kiện} & Người dùng đang đăng nhập hệ thống. \\ \hline
\textbf{Luồng chính} &
1. Vào Cài đặt $\rightarrow$ Chọn "Đổi mật khẩu".\\
& 2. Nhập mật khẩu cũ, mật khẩu mới và xác nhận mật khẩu mới.\\
& 3. Nhấn "Xác nhận".\\
& 4. Hệ thống kiểm tra mật khẩu cũ.\\
& 5. Lưu mật khẩu mới và thông báo thành công. \\ \hline
\textbf{Luồng phụ} &
4a. Sai mật khẩu cũ: Báo lỗi và yêu cầu nhập lại.\\
& 2a. Mật khẩu xác nhận không khớp: Báo lỗi nhập liệu. \\ \hline
\textbf{Hậu điều kiện} & Mật khẩu cũ không còn hiệu lực, mật khẩu mới được áp dụng. \\ \hline
\end{tabular}
\end{table}

\begin{table}[H]
\centering
\caption{UC-07: Đăng xuất}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{4cm}|p{10cm}|}
\hline
\textbf{Use Case ID} & UC-07 \\ \hline
\textbf{Actor} & Customer, Driver, Admin \\ \hline
\textbf{Mô tả} & Cho phép người dùng đăng xuất khỏi hệ thống và kết thúc phiên làm việc. \\ \hline
\textbf{Tiền điều kiện} & Người dùng đang đăng nhập hệ thống. \\ \hline
\textbf{Luồng chính} &
1. Chọn "Đăng xuất" từ menu.\\
& 2. Hệ thống yêu cầu xác nhận đăng xuất.\\
& 3. Người dùng chọn "Có".\\
& 4. Hệ thống xóa phiên đăng nhập trên thiết bị.\\
& 5. Chuyển về màn hình đăng nhập. \\ \hline
\textbf{Luồng phụ} &
3a. Chọn "Không": Hủy thao tác đăng xuất và quay lại hệ thống. \\ \hline
\textbf{Hậu điều kiện} & Ứng dụng trở về trạng thái chưa đăng nhập. \\ \hline
\end{tabular}
\end{table}

\subsection{Use case Diagram chi tiết đặt hàng và theo dõi}

\begin{figure}[H]
    \centering
    \includegraphics[height=0.35\textheight]{frontmatter/image/dathangtheodoi.jpg}
    \caption{Use case Diagram chi tiết đặt hàng và theo dõi}
    \label{fig:intro}
\end{figure}
Dưới đây là các đặc tả use case của chi tiết đặt hàng và theo dõi:

\begin{table}[H]
\centering
\caption{UC-08: Tạo đơn hàng mới}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{4cm}|p{10cm}|}
\hline
\textbf{Use Case ID} & UC-08 \\ \hline
\textbf{Actor} & Customer \\ \hline
\textbf{Mô tả} & Người dùng tạo yêu cầu giao hàng mới. Người dùng có thể chọn hình thức bưu tá đến lấy hàng tại nhà hoặc tự mang hàng ra bưu cục. \\ \hline
\textbf{Tiền điều kiện} & Tài khoản đã đăng nhập vào hệ thống. \\ \hline
\end{tabular}
\end{table}

\begin{table}[H]
\centering
\caption{UC-09: Quản lý đơn hàng đã tạo}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{4cm}|p{10cm}|}
\hline
\textbf{Use Case ID} & UC-09 \\ \hline
\textbf{Actor} & Customer \\ \hline
\textbf{Mô tả} & Người dùng xem danh sách các đơn hàng đã tạo, lọc theo trạng thái và xem chi tiết từng đơn hàng. Cho phép hủy đơn nếu đơn chưa được xử lý. \\ \hline
\textbf{Tiền điều kiện} & Người dùng đã đăng nhập vào hệ thống. \\ \hline
\textbf{Luồng chính} &
1. Actor truy cập menu "Đơn hàng của tôi".\\
& 2. Hệ thống hiển thị danh sách đơn hàng theo thời gian gần nhất.\\
& 3. Actor sử dụng bộ lọc để tìm đơn theo trạng thái xử lý.\\
& 4. Actor chọn một đơn hàng cụ thể để xem chi tiết.\\
& 5. Hệ thống hiển thị thông tin người gửi, người nhận, hàng hóa và lịch sử trạng thái. \\ \hline
\textbf{Luồng phụ} &
4a. Hủy đơn hàng: Nếu đơn ở trạng thái "Chờ xử lý", Actor chọn "Hủy đơn".\\
& \quad Hệ thống yêu cầu nhập lý do hủy và cập nhật trạng thái thành "Đã hủy".\\
& 2a. Không có dữ liệu: Hệ thống thông báo chưa có đơn hàng nào. \\ \hline
\textbf{Hậu điều kiện} & Người dùng nắm được tình trạng và chi tiết các đơn hàng của mình. \\ \hline
\end{tabular}
\end{table}

\begin{table}[H]
\centering
\caption{UC-010: Tra cứu hành trình đơn hàng}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{4cm}|p{10cm}|}
\hline
\textbf{Use Case ID} & UC-10 \\ \hline
\textbf{Actor} & Customer \\ \hline
\textbf{Mô tả} & Cho phép người dùng theo dõi vị trí và trạng thái hiện tại của đơn hàng thông qua mã vận đơn. \\ \hline
\textbf{Tiền điều kiện} & Có mã vận đơn hợp lệ. \\ \hline
\textbf{Luồng chính} &
1. Actor truy cập trang "Tra cứu đơn hàng".\\
& 2. Nhập mã vận đơn vào ô tìm kiếm.\\
& 3. Nhấn nút "Tra cứu".\\
& 4. Hệ thống truy vấn dữ liệu từ lịch sử giao hàng.\\
& 5. Hiển thị timeline hành trình gồm thời gian tạo, lấy hàng, vị trí hiện tại và trạng thái xử lý.\\
& 6. Kết thúc tra cứu. \\ \hline
\textbf{Luồng phụ} &
2a. Sai mã vận đơn: Thông báo không tìm thấy thông tin đơn hàng.\\
& 4a. Đơn hàng chưa có cập nhật: Hiển thị trạng thái vừa tạo, chưa có hành trình di chuyển. \\ \hline
\textbf{Hậu điều kiện} & Thông tin hành trình đơn hàng được hiển thị cho người dùng. \\ \hline
\end{tabular}
\end{table}

\subsection{Use case Diagram chi tiết lấy hàng và giao hàng của tài xế}

\begin{figure}[H]
    \centering
    \includegraphics[height=0.3\textheight]{frontmatter/image/layhanggiaohang.jpg}
    \caption{Use case Diagram quản lý tài khoản và xác thực}
    \label{fig:intro}
\end{figure}
Dưới đây là các đặc tả use case lấy hàng và giao hàng của tài xế:

\begin{table}[H]
\centering
\caption{UC-11: Cập nhật trạng thái hoạt động}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{4cm}|p{10cm}|}
\hline
\textbf{Use Case ID} & UC-11 \\ \hline
\textbf{Actor} & Driver \\ \hline
\textbf{Mô tả} & Tài xế chủ động thay đổi trạng thái làm việc để hệ thống xác định khả năng tiếp nhận đơn hàng mới. \\ \hline
\textbf{Tiền điều kiện} & Tài xế đã đăng nhập vào ứng dụng. \\ \hline
\textbf{Luồng chính} &
1. Actor truy cập màn hình trạng thái làm việc.\\
& 2. Hệ thống hiển thị trạng thái hiện tại.\\
& 3. Actor chọn trạng thái mới (Rảnh, Bận, Hết ca làm, Không hoạt động).\\
& 4. Hệ thống cập nhật trạng thái lên máy chủ.\\
& 5. Hệ thống điều chỉnh phân phối đơn hàng theo trạng thái mới.\\
& 6. Thông báo cập nhật thành công. \\ \hline
\textbf{Luồng phụ} &
3a. Chọn trạng thái Hết ca làm: Hệ thống kiểm tra đơn chưa hoàn thành và yêu cầu xử lý trước khi nghỉ.\\
& 4a. Mất kết nối mạng: Báo lỗi và giữ nguyên trạng thái cũ. \\ \hline
\textbf{Hậu điều kiện} & Trạng thái làm việc của tài xế được cập nhật trên toàn hệ thống. \\ \hline
\end{tabular}
\end{table}

\begin{table}[H]
\centering
\caption{UC-12: Xem lịch trình phân công}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{4cm}|p{10cm}|}
\hline
\textbf{Use Case ID} & UC-12 \\ \hline
\textbf{Actor} & Driver \\ \hline
\textbf{Mô tả} & Tài xế xem danh sách các điểm lấy hàng và giao hàng được phân công theo lộ trình tối ưu. \\ \hline
\textbf{Tiền điều kiện} & Tài xế đang ở trạng thái sẵn sàng nhận việc. \\ \hline
\textbf{Luồng chính} &
1. Actor chọn menu "Lịch trình".\\
& 2. Hệ thống tải các chuyến xe được gán.\\
& 3. Hiển thị danh sách điểm dừng gồm địa chỉ, loại tác vụ và thời gian dự kiến.\\
& 4. Actor chọn một điểm dừng để xem chi tiết người liên hệ và hàng hóa.\\
& 5. Actor chuyển sang chế độ xem bản đồ để xem tuyến đường.\\
& 6. Kết thúc xem lịch trình. \\ \hline
\textbf{Luồng phụ} &
2a. Chưa có lịch phân công: Hiển thị thông báo chưa có nhiệm vụ mới.\\
& 3a. Lịch trình thay đổi từ Admin: Tự động làm mới và gửi thông báo cập nhật. \\ \hline
\textbf{Hậu điều kiện} & Tài xế nắm được lộ trình và thứ tự công việc cần thực hiện. \\ \hline
\end{tabular}
\end{table}

\begin{table}[H]
\centering
\caption{UC-13: Thực hiện lấy hàng}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{4cm}|p{10cm}|}
\hline
\textbf{Use Case ID} & UC-13 \\ \hline
\textbf{Actor} & Driver \\ \hline
\textbf{Mô tả} & Tài xế đến địa chỉ người gửi để nhận hàng và xác nhận việc lấy hàng trên hệ thống. \\ \hline
\textbf{Tiền điều kiện} &
1. Tài xế đã nhận lịch trình.\\
& 2. Tài xế đã đến địa chỉ người gửi. \\ \hline
\textbf{Luồng chính} &
1. Actor chọn đơn hàng cần lấy trong lịch trình.\\
& 2. Actor nhấn "Bắt đầu lấy hàng".\\
& 3. Kiểm tra hàng hóa thực tế so với thông tin hệ thống.\\
& 4. Quét mã đơn hàng hoặc nhập mã xác nhận.\\
& 5. Nhấn "Xác nhận lấy hàng thành công".\\
& 6. Hệ thống cập nhật trạng thái "Đã lấy hàng".\\
& 7. Hệ thống đánh dấu nhiệm vụ đã hoàn thành. \\ \hline
\textbf{Luồng phụ} &
3a. Hàng hóa không hợp lệ: Từ chối nhận hàng và cập nhật lý do.\\
& 4a. Không liên lạc được người gửi: Ghi nhận trạng thái và xếp lịch lại. \\ \hline
\textbf{Hậu điều kiện} & Hàng hóa được chuyển sang trách nhiệm của tài xế. \\ \hline
\end{tabular}
\end{table}

\begin{table}[H]
\centering
\caption{UC-14: Thực hiện giao hàng}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{4cm}|p{10cm}|}
\hline
\textbf{Use Case ID} & UC-14 \\ \hline
\textbf{Actor} & Driver \\ \hline
\textbf{Mô tả} & Tài xế giao hàng cho người nhận và ghi nhận bằng chứng giao hàng trên hệ thống. \\ \hline
\textbf{Tiền điều kiện} &
1. Tài xế đang giữ hàng hóa cần giao.\\
& 2. Tài xế đã đến địa chỉ người nhận. \\ \hline
\textbf{Luồng chính} &
1. Actor chọn đơn hàng cần giao.\\
& 2. Liên hệ người nhận để nhận hàng.\\
& 3. Giao kiện hàng cho người nhận.\\
& 4. Chụp ảnh bằng chứng hoặc yêu cầu ký nhận.\\
& 5. Nhấn "Hoàn tất giao hàng".\\
& 6. Hệ thống cập nhật trạng thái "Giao hàng thành công".\\
& 7. Đơn hàng được đóng lại. \\ \hline
\textbf{Luồng phụ} &
2a. Người nhận vắng nhà: Hẹn lại hoặc cập nhật giao không thành công.\\
& 3a. Người nhận từ chối: Ghi nhận lý do và cập nhật trạng thái chuyển hoàn. \\ \hline
\textbf{Hậu điều kiện} & Đơn hàng hoàn tất quy trình vận chuyển. \\ \hline
\end{tabular}
\end{table}

\subsection{Đặc tả Use Case Diagram Quản trị điều phối}

\begin{figure}[H]
    \centering
    % Đã sửa tên file ảnh theo yêu cầu
    \includegraphics[width=0.9\textwidth]{frontmatter/image/quantridieuphoi.jpg} 
    \caption{Use case Diagram quản trị điều phối}
    \label{fig:quantridieuphoi}
\end{figure}

Dưới đây là bảng đặc tả chi tiết cho các Use case quan trọng của hệ thống:

% --- UC-01: QUẢN LÝ BƯU CỤC ---
\begin{table}[H]
\centering
\caption{UC-15: Quản lý Bưu cục}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{3.5cm}|p{11cm}|}
\hline
\textbf{Tên Use Case} & Quản lý Bưu cục \\ \hline
\textbf{Actor} & Admin \\ \hline
\textbf{Mô tả} & Quản trị viên thực hiện thêm mới, cập nhật thông tin, kích hoạt hoặc vô hiệu hóa các bưu cục (Post Office) để mở rộng hoặc thu hẹp mạng lưới vận chuyển. \\ \hline
\textbf{Tiền điều kiện} & Admin đã đăng nhập hệ thống. \\ \hline
\textbf{Luồng chính} &
\begin{enumerate}
    \item Actor truy cập danh sách bưu cục.
    \item Hệ thống hiển thị danh sách bưu cục cùng trạng thái hoạt động.
    \item Actor chọn chức năng "Thêm mới" hoặc chọn một bưu cục để "Chỉnh sửa".
    \item Actor nhập thông tin (Tên, Mã bưu cục, Địa chỉ, Mã vùng phụ trách).
    \item Actor thiết lập trạng thái (Kích hoạt/Vô hiệu hóa/Bảo trì).
    \item Hệ thống kiểm tra tính hợp lệ của dữ liệu (Mã không trùng lặp).
    \item Hệ thống lưu thông tin và thông báo thành công.
\end{enumerate} \\ \hline
\textbf{Luồng phụ} &
\textbf{6a. Mã bưu cục đã tồn tại:}
\begin{itemize}
    \item Hệ thống báo lỗi trùng mã định danh.
    \item Actor nhập lại mã mới.
\end{itemize} \\ \hline
\textbf{Hậu điều kiện} & Thông tin bưu cục được cập nhật vào cơ sở dữ liệu và có hiệu lực ngay lập tức. \\ \hline
\end{tabular}
\end{table}

% --- UC-16: QUẢN LÝ TÀI XẾ ---
\begin{table}[H]
\centering
\caption{UC-16: Quản lý Tài xế \& Theo dõi vị trí}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{3.5cm}|p{11cm}|}
\hline
\textbf{Tên Use Case} & Quản lý Tài xế \\ \hline
\textbf{Actor} & Admin \\ \hline
\textbf{Mô tả} & Quản lý hồ sơ tài xế, cập nhật trạng thái làm việc (Sẵn sàng/Bận/Nghỉ) và theo dõi vị trí thực (Real-time tracking) trên bản đồ. \\ \hline
\textbf{Tiền điều kiện} & Có tài xế đã đăng ký trong hệ thống. \\ \hline
\textbf{Luồng chính} &
\begin{enumerate}
    \item Actor truy cập module Quản lý tài xế.
    \item Hệ thống hiển thị danh sách tài xế và trạng thái hiện tại.
    \item Actor chọn xem chi tiết một tài xế.
    \item Hệ thống hiển thị hồ sơ cá nhân, lịch sử đơn hàng và vị trí hiện tại trên bản đồ .
    \item Actor cập nhật trạng thái tài xế.
    \item Hệ thống lưu trạng thái mới.
\end{enumerate} \\ \hline
\textbf{Luồng phụ} &
\textbf{4a. Tài xế mất tín hiệu GPS:}
\begin{itemize}
    \item Hệ thống hiển thị cảnh báo "Mất kết nối" và thời gian cập nhật lần cuối.
\end{itemize}
\textbf{5a. Tài xế đang có đơn hàng chưa hoàn thành:}
\begin{itemize}
    \item Hệ thống ngăn chặn việc chuyển trạng thái sang "Inactive" hoặc "Off Duty".
    \item Hệ thống yêu cầu hoàn thành đơn hàng hoặc điều phối lại trước.
\end{itemize} \\ \hline
\textbf{Hậu điều kiện} & Trạng thái tài xế được đồng bộ để phục vụ cho việc xếp lịch. \\ \hline
\end{tabular}
\end{table}

% --- UC-17: THEO DÕI & XỬ LÝ ĐƠN ---
\begin{table}[H]
\centering
\caption{UC-17: Theo dõi \& Xử lý đơn}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{3.5cm}|p{11cm}|}
\hline
\textbf{Tên Use Case} & Theo dõi \& Xử lý đơn \\ \hline
\textbf{Actor} & Admin \\ \hline
\textbf{Mô tả} & Quản lý vòng đời đơn hàng từ lúc tiếp nhận  đến khi hoàn tất, bao gồm việc phê duyệt, từ chối hoặc gom nhóm đơn theo vùng. \\ \hline
\textbf{Tiền điều kiện} & Có đơn hàng mới được tạo từ phía khách hàng . \\ \hline
\textbf{Luồng chính} &
\begin{enumerate}
    \item Actor xem danh sách đơn hàng mới .
    \item Actor kiểm tra thông tin chi tiết (địa chỉ, loại hàng).
    \item Actor thực hiện hành động "Phê duyệt"  để chuyển thành Order chính thức hoặc "Từ chối" .
    \item Nếu phê duyệt, hệ thống tự động gom nhóm đơn  dựa trên mã vùng .
    \item Hệ thống cập nhật trạng thái đơn hàng.
\end{enumerate} \\ \hline
\textbf{Luồng phụ} &
\textbf{3a. Từ chối đơn hàng:}
\begin{itemize}
    \item Actor nhập lý do từ chối (Sai địa chỉ, ...).
    \item Hệ thống gửi thông báo hủy đến khách hàng.
\end{itemize} \\ \hline
\textbf{Hậu điều kiện} & Đơn hàng chuyển sang trạng thái "Confirmed" và sẵn sàng để xếp lịch. \\ \hline
\end{tabular}
\end{table}

% --- UC-04: XẾP LỊCH THỦ CÔNG ---
\begin{table}[H]
\centering
\caption{UC-18: Xếp lịch thủ công}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{3.5cm}|p{11cm}|}
\hline
\textbf{Tên Use Case} & Xếp lịch thủ công \\ \hline
\textbf{Actor} & Admin \\ \hline
\textbf{Mô tả} & Cho phép Admin tự tay chọn tài xế và gán các đơn hàng cụ thể vào lịch trình của tài xế đó, thường dùng cho các trường hợp đặc biệt hoặc xử lý sự cố. \\ \hline
\textbf{Tiền điều kiện} & Đơn hàng đã được xác nhận, Tài xế đang ở trạng thái sẵn sàng. \\ \hline
\textbf{Luồng chính} &
\begin{enumerate}
    \item Actor chọn ngày và khu vực cần xếp lịch.
    \item Hệ thống hiển thị danh sách đơn chưa gán và danh sách tài xế khả dụng.
    \item Actor kéo thả hoặc chọn các đơn hàng gán cho một tài xế cụ thể.
    \item Hệ thống tính toán tải trọng và cảnh báo nếu vượt quá giới hạn.
    \item Actor xác nhận "Tạo lịch trình" .
    \item Hệ thống lưu bản ghi vào bảng.
\end{enumerate} \\ \hline
\textbf{Luồng phụ} &
\textbf{4a. Tài xế quá tải:}
\begin{itemize}
    \item Hệ thống cảnh báo tổng khối lượng/số đơn vượt mức cho phép.
    \item Actor bỏ bớt đơn hoặc xác nhận gán đè.
\end{itemize} \\ \hline
\textbf{Hậu điều kiện} & Lịch trình được tạo và gửi đến App của tài xế. \\ \hline
\end{tabular}
\end{table}

% --- UC-05: XẾP LỊCH TỰ ĐỘNG (GA) ---
\begin{table}[H]
\centering
\caption{UC-19: Xếp lịch tự động (Genetic Algorithm)}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{3.5cm}|p{11cm}|}
\hline
\textbf{Tên Use Case} & Xếp lịch tự động (GA) \\ \hline
\textbf{Actor} &Admin\\ \hline
\textbf{Mô tả} & Hệ thống sử dụng thuật toán di truyền (Genetic Algorithm) để tối ưu hóa lộ trình giao hàng, giảm thiểu quãng đường và cân bằng tải giữa các tài xế. \\ \hline
\textbf{Tiền điều kiện} & Danh sách đơn hàng lớn cần xử lý trong ngày. \\ \hline
\textbf{Luồng chính} &
\begin{enumerate}
    \item Actor chọn khu vực và nhấn "Tối ưu hóa lịch trình".
    \item Hệ thống thu thập dữ liệu đơn hàng và vị trí kho/bưu cục.
    \item Hệ thống khởi tạo quần thể (Population) các phương án lộ trình.
    \item Hệ thống chạy vòng lặp  để tìm phương án có Fitness Score cao nhất (Quãng đường ngắn nhất, thời gian nhanh nhất).
    \item Hệ thống đề xuất lịch trình tối ưu cho admin xem trước.
    \item admin xem xét và áp dụng.
\end{enumerate} \\ \hline
\textbf{Luồng phụ} &
\textbf{5a. Không tìm thấy phương án thỏa mãn:}
\begin{itemize}
    \item Do số lượng đơn quá lớn so với số tài xế.
    \item Hệ thống cảnh báo và đề xuất để lại một số đơn sang ca sau.
\end{itemize} \\ \hline
\textbf{Hậu điều kiện} & Hàng loạt lịch trình được tạo tự động nhanh chóng và tối ưu. \\ \hline
\end{tabular}
\end{table}

% --- UC-20: HỦY/CẬP NHẬT LỊCH ---
\begin{table}[H]
\centering
\caption{UC-20: Hủy/Cập nhật lịch trình}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{3.5cm}|p{11cm}|}
\hline
\textbf{Tên Use Case} & Hủy/Cập nhật lịch \\ \hline
\textbf{Actor} & Admin \\ \hline
\textbf{Mô tả} & Chỉnh sửa lịch trình đang chạy hoặc chưa chạy (thêm/bớt đơn, đổi tài xế) hoặc hủy bỏ hoàn toàn lịch trình do sự cố. \\ \hline
\textbf{Tiền điều kiện} & Lịch trình đã tồn tại. \\ \hline
\textbf{Luồng chính} &
\begin{enumerate}
    \item Actor tìm kiếm mã lịch trình (Schedule ID).
    \item Actor chọn "Chỉnh sửa".
    \item Hệ thống cho phép gỡ bỏ đơn hàng khỏi lịch (đơn sẽ quay lại trạng thái Pending) hoặc chuyển lịch sang tài xế khác.
    \item Actor lưu thay đổi.
    \item Hệ thống gửi thông báo cập nhật cho tài xế liên quan.
\end{enumerate} \\ \hline
\textbf{Luồng phụ} &
\textbf{2a. Hủy lịch trình đang chạy:}
\begin{itemize}
    \item Tài xế đã bắt đầu đi giao.
    \item Hệ thống yêu cầu xác nhận khẩn cấp và gửi thông báo dừng ngay lập tức cho tài xế.
\end{itemize} \\ \hline
\textbf{Hậu điều kiện} & Lịch trình được cập nhật lại trạng thái và dữ liệu. \\ \hline
\end{tabular}
\end{table}

% --- UC-07: XEM DASHBOARD THỐNG KÊ ---
\begin{table}[H]
\centering
\caption{UC-21: Xem Dashboard thống kê}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{3.5cm}|p{11cm}|}
\hline
\textbf{Tên Use Case} & Xem Dashboard thống kê \\ \hline
\textbf{Actor} & Admin \\ \hline
\textbf{Mô tả} & Cung cấp cái nhìn tổng quan về hiệu suất hệ thống: Tổng đơn hàng, Doanh thu, Tỷ lệ giao thành công, Hiệu suất tài xế. \\ \hline
\textbf{Tiền điều kiện} & Admin đăng nhập hệ thống. \\ \hline
\textbf{Luồng chính} &
\begin{enumerate}
    \item Actor truy cập trang chủ (Dashboard).
    \item Hệ thống truy vấn dữ liệu tổng hợp từ Database và Data Warehouse.
    \item Actor lọc dữ liệu theo khoảng thời gian (Ngày/Tuần/Tháng).
\end{enumerate} \\ \hline
\textbf{Hậu điều kiện} & Admin nắm bắt được tình hình kinh doanh để ra quyết định. \\ \hline
\end{tabular}
\end{table}

% --- UC-08: GỢI Ý MỞ BƯU CỤC MỚI ---
\begin{table}[H]
\centering
\caption{UC-22: Gợi ý mở bưu cục mới (Analytics)}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}{|p{3.5cm}|p{11cm}|}
\hline
\textbf{Tên Use Case} & Gợi ý mở bưu cục mới \\ \hline
\textbf{Actor} & Admin  \\ \hline
\textbf{Mô tả} & Hệ thống sử dụng thuật toán phân tích giỏ hàng (Market Basket Analysis - Apriori) để phân tích tần suất các tuyến đường và gợi ý vị trí tiềm năng đặt bưu cục mới. \\ \hline
\textbf{Tiền điều kiện} & Dữ liệu lịch sử đơn hàng đủ lớn được lưu trong Database. \\ \hline
\textbf{Luồng chính} &
\begin{enumerate}
    \item Actor chọn module Phân tích nâng cao.
    \item Actor chọn chức năng "Gợi ý địa điểm".
    \item Actor thiết lập tham số (Độ hỗ trợ tối thiểu - Min Support).
    \item Hệ thống chạy thuật toán khai phá dữ liệu trên các cặp điểm giao nhận phổ biến.
    \item Hệ thống hiển thị danh sách các khu vực có nhu cầu cao nhưng chưa có bưu cục phủ sóng.
    \item Hệ thống hiển thị dự báo doanh thu nếu mở bưu cục tại đó.
\end{enumerate} \\ \hline
\textbf{Hậu điều kiện} & Admin có dữ liệu định lượng để quyết định chiến lược mở rộng. \\ \hline
\end{tabular}
\end{table}

